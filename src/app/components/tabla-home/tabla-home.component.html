<div class="estado-chips">
  <button class="chip" [class.active]="activeFilter === 'aceptado'"
    (click)="setFilter(activeFilter === 'aceptado' ? 'todos' : 'aceptado')" aria-label="Filtrar por aceptado">
    <span class="icon ok" aria-hidden="true">
      <!-- check-circle -->
      <svg viewBox="0 0 24 24">
        <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm-1 14-4-4 1.4-1.4L11 12.2l4.6-4.6L17 9l-6 7Z" />
      </svg>
    </span>
    Aceptado
    <span class="count" *ngIf="counts.aceptado">{{ counts.aceptado }}</span>
  </button>

  <button class="chip" [class.active]="activeFilter === 'rechazado'"
    (click)="setFilter(activeFilter === 'rechazado' ? 'todos' : 'rechazado')" aria-label="Filtrar por rechazado">
    <span class="icon error" aria-hidden="true">
      <!-- close-circle -->
      <svg viewBox="0 0 24 24">
        <path
          d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm3.5 13.1-1.4 1.4L12 13.4l-2.1 2.1-1.4-1.4L10.6 12 8.5 9.9l1.4-1.4L12 10.6l2.1-2.1 1.4 1.4L13.4 12l2.1 2.1Z" />
      </svg>
    </span>
    Rechazado
    <span class="count" *ngIf="counts.rechazado">{{ counts.rechazado }}</span>
  </button>

  <button class="chip" [class.active]="activeFilter === 'pendiente'"
    (click)="setFilter(activeFilter === 'pendiente' ? 'todos' : 'pendiente')" aria-label="Filtrar por pendientes">
    <span class="icon warn" aria-hidden="true">
      <!-- warning-triangle -->
      <svg viewBox="0 0 24 24">
        <path
          d="M12.9 2.5a1.5 1.5 0 0 0-2.6 0L1.5 18.1A1.5 1.5 0 0 0 2.8 20h18.4a1.5 1.5 0 0 0 1.3-1.9L12.9 2.5ZM12 8c.55 0 1 .45 1 1v5a1 1 0 1 1-2 0V9c0-.55.45-1 1-1Zm0 9a1.25 1.25 0 1 1 0-2.5A1.25 1.25 0 0 1 12 17Z" />
      </svg>
    </span>
    Pendientes
    <span class="count" *ngIf="counts.pendiente">{{ counts.pendiente }}</span>
  </button>
</div>

<div class="card">
  <div class="card__header">
    <h2 class="card__title">{{ titulo }}</h2>
  </div>

  <div class="table-wrap">
    <table class="tabla">
      <thead>
        <tr>
          <th>Código de Aprobación</th>
          <th>Nombre Interno</th>
          <th>Producto</th>
          <th>Fabricante</th>
          <th class="col-estado">Estados</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let r of filtered; trackBy: trackByRow">
          <td>{{ r.codigo || '' }}</td>
          <td>{{ r.nombreInterno || '' }}</td>
          <td class="col-producto" [title]="r.producto">{{ r.producto }}</td>
          <td class="col-fabricante" [title]="r.fabricante">{{ r.fabricante }}</td>
          <td class="col-estado">
            <span class="estado-pill" [class.ok]="r.estado === 'aceptado'" [class.error]="r.estado === 'rechazado'"
              [class.warn]="r.estado === 'pendiente'" [attr.aria-label]="r.estado">
              <svg viewBox="0 0 24 24" *ngIf="r.estado === 'aceptado'">
                <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm-1 14-4-4 1.4-1.4L11 12.2l4.6-4.6L17 9l-6 7Z" />
              </svg>
              <svg viewBox="0 0 24 24" *ngIf="r.estado === 'rechazado'">
                <path
                  d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm3.5 13.1-1.4 1.4L12 13.4l-2.1 2.1-1.4-1.4L10.6 12 8.5 9.9l1.4-1.4L12 10.6l2.1-2.1 1.4 1.4L13.4 12l2.1 2.1Z" />
              </svg>
              <svg viewBox="0 0 24 24" *ngIf="r.estado === 'pendiente'">
                <path
                  d="M12.9 2.5a1.5 1.5 0 0 0-2.6 0L1.5 18.1A1.5 1.5 0 0 0 2.8 20h18.4a1.5 1.5 0 0 0 1.3-1.9L12.9 2.5ZM12 8c.55 0 1 .45 1 1v5a1 1 0 1 1-2 0V9c0-.55.45-1 1-1Zm0 9a1.25 1.25 0 1 1 0-2.5A1.25 1.25 0 0 1 12 17Z" />
              </svg>
            </span>
          </td>
        </tr>

        <tr *ngIf="filtered.length === 0">
          <td colspan="5" class="empty">No hay registros para este filtro.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="card__footer">
    <button class="btn-primary" type="button" (click)="verMas.emit()">Ver Más...</button>
  </div>
</div>
